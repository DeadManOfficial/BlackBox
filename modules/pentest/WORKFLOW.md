# DeadMan Pen - Hyper-Cyclic Attack Workflow

> Integrated from Black Hat 2026 Threat Taxonomy + DeadMan Toolkit (116 tools)
>
> **RULEBOOK:** `~/BlackBox/docs/BOUNTY_RULEBOOK.md` - Bounty hunting protocol

---

## Master Workflow Tree

```
                            ┌─────────────────────────────────────┐
                            │         TARGET ACQUISITION          │
                            │    (Scope, Authorization, Intel)    │
                            └─────────────────┬───────────────────┘
                                              │
                                              ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                    PHASE 1: INTELLIGENCE GATHERING                     ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  OSINT → Passive Recon → Active Recon → Attack Surface Mapping        ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ intel_cve_search │           │ intel_exploit    │         │ nuclei_scan │ │
│   │ intel_github     │           │ intel_mitre      │         │ js_analyze  │ │
│   │ intel_bugbounty  │           │ intel_tech_vulns │         │ stealth_*   │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                    PHASE 2: WEAPONIZATION                              ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  Payload Dev → Exploit Selection → Infrastructure Prep → C2 Setup     ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ llm_redteam_*    │           │ indirect_inject  │         │ crescendo_  │ │
│   │ ai_security_test │           │ waf_bypass_*     │         │ pentest_*   │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                    PHASE 3: INITIAL ACCESS                             ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  Phishing → Exploit Public Apps → Supply Chain → Valid Accounts       ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ backend_access   │           │ oauth_scan       │         │ payment_*   │ │
│   │ cloud_storage    │           │ cors_auth_scan   │         │ graphql_*   │ │
│   │ ssrf_scan        │           │ xxe_scan         │         │ ssti_scan   │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                    PHASE 4: EXECUTION & STEALTH                        ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  Command Execution → Script Execution → Native API → Evasion          ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ stealth_fetch    │           │ stealth_session  │         │ waf_bypass  │ │
│   │ race_condition   │           │ stealth_engines  │         │ pentest_run │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                    PHASE 5: PRIVILEGE ESCALATION                       ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  Local Privesc → Domain Escalation → Cloud Escalation → Container     ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ pentest_run      │           │ backend_access   │         │ oauth_scan  │ │
│   │ (post-exploit)   │           │ (admin endpoints)│         │ (token leak)│ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                PHASE 6: DISCOVERY & LATERAL MOVEMENT                   ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  Network Discovery → Service Enum → Credential Access → Pivoting      ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ cloud_storage    │           │ js_analyze       │         │ nuclei_scan │ │
│   │ (bucket enum)    │           │ (secrets/keys)   │         │ (internal)  │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                    PHASE 7: COMMAND & CONTROL                          ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  C2 Establishment → Protocol Tunneling → Domain Fronting → Fallback   ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │  (Manual Phase)  │           │ stealth_session  │         │ waf_bypass  │ │
│   │  Document C2     │           │ (maintain access)│         │ (evasion)   │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                PHASE 8: DATA COLLECTION & EXFILTRATION                 ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  Data Staging → Collection → Compression → Exfil Channels             ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ backend_access   │           │ cloud_storage    │         │ payment_*   │ │
│   │ (data dump)      │           │ (list all files) │         │ (txn data)  │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│   ╔═══════════════════════════════════════════════════════════════════════╗    │
│   ║                PHASE 9: AI INFLUENCE & AGENT ATTACKS                   ║    │
│   ╠═══════════════════════════════════════════════════════════════════════╣    │
│   ║  AI-Jacking → AgentFlayer → Model Poisoning → Prompt Injection        ║    │
│   ╚═══════════════════════════════════════════════════════════════════════╝    │
│                                              │                                  │
│              ┌───────────────────────────────┼───────────────────────────┐     │
│              ▼                               ▼                           ▼     │
│   ┌──────────────────┐           ┌──────────────────┐         ┌─────────────┐ │
│   │ llm_redteam_scan │           │ indirect_inject  │         │ crescendo_  │ │
│   │ ai_security_test │           │ (zero-click)     │         │ attack      │ │
│   └──────────────────┘           └──────────────────┘         └─────────────┘ │
│                                              │                                  │
└──────────────────────────────────────────────┼──────────────────────────────────┘
                                               │
                                               ▼
                            ┌─────────────────────────────────────┐
                            │           DOCUMENTATION             │
                            │   (Reports, Evidence, Remediation)  │
                            └─────────────────────────────────────┘
```

---

## Hyper-Cyclic Attack Model

Unlike linear kill chains, the **Hyper-Cyclic Model** allows:
- **Recursive loops** between any phases
- **Parallel execution** of multiple attack paths
- **Dynamic pivoting** based on discovered opportunities

```
                    ┌──────────────────────────────────────────┐
                    │          HYPER-CYCLIC CORE               │
                    │                                          │
                    │    ┌─────┐     ┌─────┐     ┌─────┐      │
                    │    │ P1  │◄───►│ P2  │◄───►│ P3  │      │
                    │    └──┬──┘     └──┬──┘     └──┬──┘      │
                    │       │    ╲      │      ╱    │         │
                    │       │     ╲     │     ╱     │         │
                    │       ▼      ╲    ▼    ╱      ▼         │
                    │    ┌─────┐    ╲┌─────┐╱    ┌─────┐      │
                    │    │ P9  │◄────│ HUB │────►│ P4  │      │
                    │    └──┬──┘    ╱└─────┘╲    └──┬──┘      │
                    │       │     ╱    │     ╲     │         │
                    │       │    ╱     │      ╲    │         │
                    │       ▼   ╱      ▼       ╲   ▼         │
                    │    ┌─────┐     ┌─────┐     ┌─────┐      │
                    │    │ P8  │◄───►│ P7  │◄───►│ P6  │      │
                    │    └─────┘     └─────┘     └──┬──┘      │
                    │                               │         │
                    │                            ┌─────┐      │
                    │                            │ P5  │      │
                    │                            └─────┘      │
                    │                                          │
                    └──────────────────────────────────────────┘

    P1 = Intelligence    P4 = Execution      P7 = C2
    P2 = Weaponization   P5 = Escalation     P8 = Collection
    P3 = Initial Access  P6 = Discovery      P9 = AI Influence
```

---

## Infrastructure Segmentation (4 Stages)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           ATTACK INFRASTRUCTURE                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ STAGE 0: STAGING / BURN                                                │ │
│  │ ─────────────────────────────────────────────────────────────────────  │ │
│  │ • Disposable infrastructure for initial contact                        │ │
│  │ • Burn after first use                                                 │ │
│  │ • Maps to: targets/ (active assessments)                               │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│                                    ▼                                         │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ STAGE 1: PERSISTENCE                                                   │ │
│  │ ─────────────────────────────────────────────────────────────────────  │ │
│  │ • Long-term access infrastructure                                      │ │
│  │ • Callback and beacon management                                       │ │
│  │ • Maps to: assessments/ (in-progress work)                             │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│                                    ▼                                         │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ STAGE 2: INTERACTIVE                                                   │ │
│  │ ─────────────────────────────────────────────────────────────────────  │ │
│  │ • Operator interaction layer                                           │ │
│  │ • Command execution and data staging                                   │ │
│  │ • Maps to: tools/ (custom scripts, utilities)                          │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│                                    ▼                                         │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │ STAGE 3: EXFILTRATION                                                  │ │
│  │ ─────────────────────────────────────────────────────────────────────  │ │
│  │ • Data collection and extraction                                       │ │
│  │ • Evidence packaging                                                   │ │
│  │ • Maps to: reports/ (final deliverables)                               │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## DeadMan Pen Workspace Mapping

```
BlackBox/
│
├── targets/                    ← STAGE 0: Active Assessments
│   └── <target-name>/
│       └── results/
│           ├── infrastructure/ ← Phase 1: Intel results
│           ├── storage/        ← Phase 6: Discovery results
│           ├── api/            ← Phase 3: Access testing
│           ├── vulnerabilities/← Phase 4-5: Exploit findings
│           └── reports/        ← Documentation
│
├── assessments/                ← STAGE 1: In-Progress Work
│   └── <engagement>/
│       ├── notes/
│       ├── evidence/
│       └── timeline/
│
├── tools/                      ← STAGE 2: Custom Scripts
│   ├── recon/
│   ├── exploit/
│   ├── post-exploit/
│   └── reporting/
│
├── templates/                  ← Report Templates
│   ├── executive-summary.md
│   ├── technical-report.md
│   └── remediation-guide.md
│
├── reports/                    ← STAGE 3: Final Deliverables
│   └── <target>-<date>/
│       ├── executive-summary.pdf
│       ├── technical-report.pdf
│       └── evidence/
│
└── archive/                    ← Completed Engagements
    └── <target>-<date>/
```

---

## Scanner Tool Mapping by Phase

### Phase 1: Intelligence Gathering
| Tool | MITRE | Description |
|------|-------|-------------|
| `intel_cve_search` | T1592 | Search NVD for CVEs |
| `intel_exploit_search` | T1592 | Search Exploit-DB |
| `intel_github_advisory` | T1592 | Package vulnerabilities |
| `intel_nuclei_templates` | T1592 | Detection signatures |
| `intel_mitre_attack` | T1592 | ATT&CK technique lookup |
| `intel_bugbounty` | T1592 | Disclosed vulns |
| `intel_comprehensive` | T1592 | Multi-source search |
| `intel_tech_vulns` | T1592 | Tech-specific vulns |

### Phase 2: Weaponization
| Tool | MITRE | Description |
|------|-------|-------------|
| `llm_redteam_scan` | T1588 | LLM attack payloads |
| `llm_redteam_payloads` | T1588 | Payload library |
| `indirect_injection_methods` | T1588 | Injection techniques |
| `fabric_generate` | T1588 | Prompt weaponization |

### Phase 3: Initial Access
| Tool | MITRE | Description |
|------|-------|-------------|
| `backend_access_scan` | T1190 | Supabase/Firebase direct |
| `cloud_storage_enum` | T1530 | S3/Vercel enumeration |
| `oauth_scan` | T1078 | OAuth vulnerabilities |
| `cors_auth_scan` | T1189 | CORS + auth exploitation |
| `ssrf_scan` | T1190 | Server-side request forgery |
| `ssti_scan` | T1190 | Template injection |
| `xxe_scan` | T1190 | XML external entity |
| `graphql_scan` | T1190 | GraphQL introspection |

### Phase 4: Execution & Stealth
| Tool | MITRE | Description |
|------|-------|-------------|
| `stealth_fetch` | T1027 | Anti-detect browsing |
| `stealth_session` | T1027 | Session rotation |
| `stealth_engines` | T1027 | Engine selection |
| `waf_bypass_scan` | T1027 | Origin IP discovery |
| `waf_bypass_request` | T1027 | Encoding bypass |
| `race_condition_scan` | T1499 | TOCTOU attacks |

### Phase 5: Privilege Escalation
| Tool | MITRE | Description |
|------|-------|-------------|
| `pentest_run` | T1068 | Autonomous escalation |
| `pentest_attack_path` | T1068 | MCTS path planning |
| `backend_access_scan` | T1078 | Admin endpoint access |
| `oauth_scan` | T1078 | Token privilege abuse |

### Phase 6: Discovery & Lateral Movement
| Tool | MITRE | Description |
|------|-------|-------------|
| `nuclei_scan` | T1046 | Service enumeration |
| `js_analyze` | T1552 | Secret extraction |
| `js_analyze_batch` | T1552 | Batch analysis |
| `cloud_storage_enum` | T1083 | Storage discovery |

### Phase 7: Command & Control
| Tool | MITRE | Description |
|------|-------|-------------|
| `stealth_session` | T1071 | Maintain access |
| `waf_bypass_request` | T1071 | Evasive comms |

### Phase 8: Data Collection & Exfiltration
| Tool | MITRE | Description |
|------|-------|-------------|
| `backend_access_scan` | T1005 | Database extraction |
| `cloud_storage_enum` | T1530 | Storage data |
| `payment_injection_scan` | T1005 | Transaction data |

### Phase 9: AI Influence
| Tool | MITRE | Description |
|------|-------|-------------|
| `llm_redteam_scan` | T1059 | Full LLM assessment |
| `ai_security_test` | T1059 | Basic AI testing |
| `indirect_injection_test` | T1059 | Zero-click injection |
| `crescendo_attack` | T1059 | Multi-turn escalation |

---

## AI-Jacking Attack Tree

```
                          ┌─────────────────────────┐
                          │      AI-JACKING         │
                          │   (Agent Compromise)    │
                          └───────────┬─────────────┘
                                      │
           ┌──────────────────────────┼──────────────────────────┐
           │                          │                          │
           ▼                          ▼                          ▼
┌─────────────────────┐   ┌─────────────────────┐   ┌─────────────────────┐
│  PROMPT INJECTION   │   │    AGENTFLAYER      │   │   MODEL POISONING   │
│  ─────────────────  │   │  ─────────────────  │   │  ─────────────────  │
│  Direct injection   │   │  Zero-click via     │   │  Training data      │
│  Indirect injection │   │  tool manipulation  │   │  manipulation       │
│  Jailbreaks         │   │  Memory corruption  │   │  Backdoor triggers  │
│  System prompt leak │   │  Context hijacking  │   │  Output steering    │
└─────────┬───────────┘   └─────────┬───────────┘   └─────────────────────┘
          │                         │
          │                         │
          ▼                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DEADMAN TOOLKIT COVERAGE                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  llm_redteam_scan        → Full OWASP LLM Top 10 + Agentic Top 5            │
│  ai_security_test        → Basic prompt injection & jailbreak tests         │
│  indirect_injection_test → Unicode, steganographic, markdown injection      │
│  crescendo_attack        → Multi-turn gradual escalation                    │
│  llm_redteam_categories  → 40+ vulnerability types                          │
│  llm_redteam_payloads    → Attack payload library                           │
│                                                                              │
│  Attack Strategies:                                                          │
│  ├── direct           → Single-shot attack payloads                         │
│  ├── multi_turn       → Gradual escalation over turns                       │
│  ├── crescendo        → Start benign, escalate to malicious                 │
│  ├── encoding         → Base64, rot13, unicode obfuscation                  │
│  ├── roleplay         → Character/scenario-based attacks                    │
│  ├── chain_of_thought → Exploit reasoning transparency                      │
│  ├── tool_manipulation→ Agent tool misuse                                   │
│  └── memory_poisoning → Corrupt agent memory/context                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Quick Reference: Complete Scanner Inventory

### Core (3)
- `nuclei_scan` - CVE & misconfig scanning
- `js_analyze` / `js_analyze_batch` - JavaScript secret detection
- `security_pipeline` - Full assessment pipeline

### Backend Access (2)
- `backend_access_scan` - Supabase/Firebase direct access
- `cloud_storage_enum` - S3/Vercel bucket enumeration

### Payment (2)
- `payment_injection_scan` - Stripe parameter injection
- `payment_webhook_test` - Webhook signature bypass

### Web Vulns (6)
- `cors_scan` / `cors_auth_scan` - CORS misconfiguration
- `ssrf_scan` - Server-side request forgery
- `ssti_scan` - Template injection
- `xxe_scan` - XML external entity
- `graphql_scan` - GraphQL introspection/batching

### LLM/AI (6)
- `ai_security_test` / `ai_security_categories`
- `llm_redteam_scan` / `llm_redteam_categories` / `llm_redteam_payloads`
- `crescendo_attack`

### Autonomous Pentest (3)
- `pentest_run` - Autonomous penetration test
- `pentest_attack_path` - MCTS attack planning
- `pentest_tools` - Available tool listing

### Stealth Browser (3)
- `stealth_fetch` - Anti-detect fetch
- `stealth_session` - Rotation session
- `stealth_engines` - Engine listing

### Advanced Attacks (8)
- `waf_bypass_scan` / `waf_bypass_request` - WAF bypass
- `race_condition_scan` / `race_condition_batch` - Race conditions
- `indirect_injection_test` / `indirect_injection_methods` - Indirect injection
- `oauth_scan` / `oauth_categories` - OAuth testing
- `payment_security_test` / `payment_categories` - Payment security

### Intelligence (9)
- `intel_cve_search` - NVD CVE lookup
- `intel_exploit_search` - Exploit-DB search
- `intel_github_advisory` - GitHub advisories
- `intel_nuclei_templates` - Nuclei templates
- `intel_bugbounty` - Bug bounty reports
- `intel_mitre_attack` - MITRE ATT&CK
- `intel_comprehensive` - Multi-source
- `intel_tech_vulns` - Tech-specific
- `intel_sources` - Source listing

**Total: 59 Security Tools**

---

## Verification Rules (Mandatory Checks)

These verification steps MUST be performed to validate findings before reporting.

### IDOR Verification Protocol

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         IDOR VERIFICATION CHECKLIST                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  1. IDENTIFY YOUR ACCOUNT                                                   │
│     □ Extract current user ID from session/localStorage/cookies             │
│     □ Document: MY_USER_ID = _____                                          │
│     □ Extract any other identifiers (org_id, team_id, project_id)          │
│                                                                              │
│  2. FIND OTHER USERS' IDENTIFIERS                                           │
│     □ Check public content (demo projects, shared links, public profiles)  │
│     □ Enumerate from API responses that leak user IDs                       │
│     □ Check invitation links, affiliate links, collection shares           │
│     □ Document: OTHER_USER_ID = _____ (source: _____)                      │
│                                                                              │
│  3. TEST CROSS-ACCOUNT ACCESS                                               │
│     □ Request YOUR data with YOUR ID → Should return YOUR data             │
│     □ Request OTHER USER's data with THEIR ID → Should return 403/401      │
│     □ If returns 200 with data → CONFIRMED IDOR                            │
│     □ If returns 200 with empty → POTENTIAL IDOR (needs user with data)    │
│                                                                              │
│  4. VERIFY DATA OWNERSHIP                                                   │
│     □ If data returned, verify it belongs to OTHER user, NOT you           │
│     □ Check timestamps, usernames, content that proves ownership           │
│     □ Document evidence with screenshots/response data                      │
│                                                                              │
│  5. TEST WRITE OPERATIONS (with extreme caution)                            │
│     □ Only if authorized and in-scope                                       │
│     □ Use reversible operations only                                        │
│     □ Document before/after state                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Finding Verification Matrix

| Finding Type | Verification Required | Evidence Needed |
|--------------|----------------------|-----------------|
| **IDOR** | Cross-account access with DIFFERENT user's data | Response showing other user's data |
| **SSRF** | Server-initiated request to controlled endpoint | Callback/DNS log, response data |
| **Auth Bypass** | Access without valid credentials | Response with authenticated data |
| **Info Disclosure** | Data should not be accessible | Response with sensitive data |
| **Injection** | Server-side execution/manipulation | Error message, modified response |

### Common Verification Mistakes (AVOID)

```
✗ WRONG: "Endpoint returns 200 for any ID" → This alone is NOT IDOR
✓ RIGHT: "Endpoint returns 200 with OTHER USER'S data for their ID"

✗ WRONG: "I can access /api/users/{id}" → Accessing your own data is expected
✓ RIGHT: "I can access /api/users/{OTHER_ID} and see their email/projects"

✗ WRONG: "Parameter is reflected in response" → This may be normal behavior
✓ RIGHT: "Parameter allows accessing resources I shouldn't have access to"
```

### ID Enumeration Sources

| Source | Method | Example |
|--------|--------|---------|
| Public profiles | View page source, network tab | `/users/public_username` |
| Shared content | Check shared links | `/share/abc123` → owner_id in response |
| Demo content | Inspect demo data | Demo projects often have real user IDs |
| API leaks | Check list endpoints | `/api/comments` may leak user IDs |
| Invite links | Decode invite tokens | JWT/base64 may contain user IDs |
| Affiliate links | URL parameters | `/affiliate/user_abc123` |
| Error messages | Trigger errors | "User user_xyz not found" |

---

## Execution Flow Example

```
Target: example.com
Authorization: Bug Bounty Scope

PHASE 1 → Intelligence
├── intel_comprehensive "example.com"
├── intel_tech_vulns "nextjs"
└── intel_cve_search "example.com dependencies"

PHASE 2 → Weaponization (if AI target)
├── llm_redteam_categories
└── fabric_get "analyze_threat_model"

PHASE 3 → Initial Access Testing
├── nuclei_scan example.com
├── js_analyze_batch [all JS files]
├── backend_access_scan supabase
├── cloud_storage_enum vercel_blob
├── cors_auth_scan api.example.com
└── oauth_scan auth.example.com

PHASE 4 → Stealth Testing
├── stealth_fetch protected-endpoints
├── waf_bypass_scan example.com
└── race_condition_scan checkout-endpoint

PHASE 5-6 → Escalation & Discovery
├── pentest_run example.com --phases recon,scanning
└── js_analyze (extract more secrets)

PHASE 9 → AI Testing (if applicable)
├── llm_redteam_scan api.example.com/chat
├── indirect_injection_test
└── crescendo_attack

DOCUMENT → Generate Report
└── Write to reports/example.com-2026-01-24/
```

---

---

## Token Optimization (Context Management)

**MANDATORY for all operations to prevent context overflow.**

### Token Axioms (T0-T4)
```
T0: ToolSearch BEFORE MCP calls (46% reduction)
    → ToolSearch("nuclei scan") BEFORE nuclei_scan()

T1: Truncate responses > 10KB (head+tail pattern)
    → Preserve 60% head + 40% tail, drop middle

T2: Checkpoint after each PHASE
    → Save: targets/{target}/checkpoints/PHASE_{n}.json
    → Return: summary + path reference

T3: Files for data, context for summary
    → NEVER return full response data inline
    → ALWAYS save to file, return path + summary

T4: Batch operations in chunks of 10
    → Process 10 URLs at a time, checkpoint between batches
```

### Phase Checkpoint Pattern
```
After completing each Phase (1-9):
1. Save full results to targets/{target}/phase_{n}_results.json
2. Return 3-5 line summary:
   "PHASE {n} COMPLETE
   - Key findings: {count}
   - Critical: {count}
   - Next: PHASE {n+1}
   - Path: {file_path}"
3. Load summary for next phase, reference file for details
```

### MCP Tool Loading Protocol
```
CORRECT:
  ToolSearch("intel comprehensive")  # 1. Load tool first
  intel_comprehensive(query="...")    # 2. Then execute

WRONG:
  intel_comprehensive(query="...")    # Direct call = context bloat
```

### Scraping Optimization
```python
# Always use minimal format
mcp__firecrawl__firecrawl_scrape(
    url="...",
    formats=["markdown"],          # NOT rawHtml
    onlyMainContent=True,          # Skip chrome
    excludeTags=["script", "style", "nav", "footer"]
)
```

### Context Reset Triggers
- After completing a Phase
- After processing 50+ items
- After receiving large MCP response
- Before starting unrelated task

### Related Modules
| Module | Purpose |
|--------|---------|
| `~/BlackBox/modules/utils/response_handler.py` | truncate(), summarize() |
| `~/BlackBox/modules/utils/gate_checkpoint.py` | checkpoint(), get_summary() |
| `~/BlackBox/modules/utils/token_rules.py` | BatchProcessor, @enforce_token_rules |

---

*DeadMan Pen Workflow v1.0 - Hyper-Cyclic Attack Methodology*
*Integrated from Black Hat 2026 Threat Taxonomy*
