# DeadMan Pen - Autonomous Pentest Orchestrator Configuration
# Default operational constraints

constraints:
  rate_limiting:
    default_rps: 10                    # Requests per second
    aggressive_rps: 50                 # For time-sensitive tests
    stealth_rps: 1                     # For evasion mode

  scope_boundaries:
    enforce: true
    allow_subdomains: true
    allow_related_domains: false       # Must be explicitly added
    blocked_paths:
      - "/admin/delete"
      - "/api/destroy"
      - "/api/drop"
      - "/admin/purge"
    blocked_actions:
      - "data_destruction"
      - "service_disruption"
      - "dos_attack"
      - "mass_mailing"

  time_windows:
    enabled: false                     # Set true for stealth operations
    allowed_hours: [22, 23, 0, 1, 2, 3, 4, 5]  # Night hours (10 PM - 6 AM)
    timezone: "UTC"

  safety:
    safe_mode: true                    # No destructive actions
    require_confirmation_for:
      - "exploit_execution"
      - "data_exfiltration"
      - "persistence_installation"
      - "credential_brute_force"
    max_parallel_workers: 10
    max_requests_per_target: 1000
    respect_robots_txt: false          # For pentesting, usually ignored

  persistence:
    auto_save_interval: 60             # Seconds
    backup_on_phase_complete: true
    export_format: "json"
    db_path: "G:/deadman-pen/state.db"

# Goal defaults
goals:
  access_level:
    enabled: true
    target: "admin"                    # anonymous, user, admin, root

  assets:
    enabled: true
    targets:
      - database
      - source_code
      - api_keys
      - pii
      - credentials

  vulnerabilities:
    enabled: true
    thresholds:
      critical: 5
      high: 10
      medium: 20

  enumeration:
    enabled: true
    coverage_target: 0.95              # 95% coverage

# Phase configuration
phases:
  P1_intelligence:
    name: "Intelligence Gathering"
    description: "Passive and active reconnaissance"
    tools:
      - intel_comprehensive
      - intel_tech_vulns
      - api_enumerate
      - stealth_fetch
    timeout_minutes: 30

  P2_weaponization:
    name: "Weaponization"
    description: "Prepare attack vectors based on intel"
    tools:
      - intel_cve_search
      - intel_exploit_search
      - hybrid_plan_attack
    timeout_minutes: 15

  P3_initial_access:
    name: "Initial Access"
    description: "Gain initial foothold"
    tools:
      - nuclei_scan
      - js_analyze_batch
      - backend_access_scan
      - oauth_scan
      - cors_scan
    timeout_minutes: 60

  P4_execution:
    name: "Execution"
    description: "Execute attacks"
    tools:
      - ssrf_scan
      - ssti_scan
      - command_injection_scan
      - xxe_scan
      - graphql_scan
    timeout_minutes: 45

  P5_privilege_escalation:
    name: "Privilege Escalation"
    description: "Escalate privileges"
    tools:
      - jwt_analyze
      - idor_scan
      - auth_flow_attack
      - race_condition_scan
    timeout_minutes: 45

  P6_discovery:
    name: "Discovery"
    description: "Enumerate accessible resources"
    tools:
      - cloud_storage_enum
      - api_enumerate
      - graphql_scan
    timeout_minutes: 30

  P7_lateral_movement:
    name: "Lateral Movement"
    description: "Move to other systems"
    tools:
      - subdomain_takeover_scan
      - waf_bypass_scan
    timeout_minutes: 30

  P8_exfiltration:
    name: "Exfiltration"
    description: "Extract valuable data"
    tools:
      - db_error_exploit
      - backend_access_scan
    timeout_minutes: 30

  P9_ai_influence:
    name: "AI Influence"
    description: "Attack AI/LLM systems"
    tools:
      - ai_security_test
      - llm_redteam_scan
      - indirect_injection_test
      - crescendo_attack
    timeout_minutes: 60

# Technology-specific configurations
technology_configs:
  supabase:
    priority_tools:
      - backend_access_scan
      - db_error_exploit
    anon_key_extraction: true
    storage_enum: true

  firebase:
    priority_tools:
      - backend_access_scan
    rules_check: true
    storage_enum: true

  nextjs:
    priority_tools:
      - js_analyze_batch
      - api_enumerate
    source_map_check: true
    api_route_enum: true

  stripe:
    priority_tools:
      - payment_security_test
      - payment_injection_scan
      - payment_webhook_test
    all_categories: true

  graphql:
    priority_tools:
      - graphql_scan
    introspection_check: true
    batching_test: true
    deep_query_test: true

  openai:
    priority_tools:
      - ai_security_test
      - llm_redteam_scan
      - indirect_injection_test
    all_strategies: true

# Logging configuration
logging:
  level: "INFO"                        # DEBUG, INFO, WARNING, ERROR
  file: "G:/deadman-pen/logs/orchestrator.log"
  max_size_mb: 100
  backup_count: 5
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# Report configuration
reporting:
  auto_generate: true
  format: "markdown"                   # markdown, html, json
  include_evidence: true
  include_remediation: true
  output_dir: "G:/deadman-pen/reports"
